swagger: "2.0"
info:
  description: "Ready to deploy REST API based in vert.x framework with lots of plumbing code and documentation to quickly develope an API without any waste of time."
  version: "0.0.1"
  title: "ssv-api (Starter Single Verticle API)"
#  termsOfService: "http://localost:8080/terms/"
#  contact:
#    email: "ssv-api@gmail.com"
#  license:
#    name: "Apache 2.0"
#    url: "http://www.apache.org/licenses/LICENSE-2.0.html"
host: "localhost:8080"
#host: "destinatarios-test.anf.es"
basePath: "/"
tags:
- name: "Admin"
  description: "Admin operations"
- name: "Test"
  description: "Endpoints to show vertx functionalities"
schemes:
- "https"
- "http"
securityDefinitions:
  basicAuth:
    type: basic
security:
  - basicAuth: []
paths:
  /admin/version:
    get:
      tags:
      - "Admin"
      summary: "API version"
      description: "Returns the deployed API version"
      operationId: "GET/admin/version"
      produces:
      - "application/json"
      responses:
        200:
          description: "Successfull operation"
          schema:
            $ref: "#/definitions/Version"
        401:
          $ref: '#/responses/UnauthorizedError'
        500:
          $ref: '#/responses/InternalServerError'
  /admin/logs:
    get:
      tags:
      - "Admin"
      summary: "Returns a file logs"
      description: "Searches in logs directoy and returns the logs file that matches with the specified day."
      operationId: "GET/admin/logs"
      produces:
      - "text/plain"
      parameters:
      - name: "backward_days"
        in: "query"
        description: "Sustract this number to actual date and you will obtain the date of the logs file to return."
        required: true
        type: "integer"
      responses:
        200:
          description: "Successfull operation"
        400:
          description: "The requiered logs file does not exists."
        401:
          $ref: '#/responses/UnauthorizedError'
        500:
          $ref: '#/responses/InternalServerError'
    delete:
      tags:
      - "Admin"
      summary: "Cleans the logs directory."
      description: "Cleans the logs directory but do not remove the logs file from today."
      operationId: "DEL/admin/logs"
      produces:
      - "text/plain"
      responses:
        200:
          description: "Successfull operation"
        401:
          $ref: '#/responses/UnauthorizedError'
        500:
          $ref: '#/responses/InternalServerError'
  /test/blocking:
    get:
      tags:
      - "Test"
      summary: "Endpoint that execute any blocking operation like access to a database."
      description: "The event loop is free to receive other calls but when finish the execution of this code a response is returned to the routing context. This is recomended to handle short blocking operations."
      operationId: "GET/test/blocking"
      produces:
      - "application/json"
      responses:
        200:
          description: "Operación exitosa"
          schema:
            $ref: "#/definitions/DestinatariosCount"
        401:
          $ref: '#/responses/UnauthorizedError'
        404:
          description: "No existe en la base de datos ninguna empresa que cumpla con los criterios de busqueda"
        500:
          $ref: '#/responses/InternalServerError'
  /test/blocking-async:
    get:
      tags:
      - "Destinatarios"
      summary: "Busca una empresa por su nombre"
      description: "Devuelve todos los datos de una empresa"
      operationId: "GET/destinatario"
      produces:
      - "application/json"
      parameters:
      - name: "name"
        in: "query"
        description: "nombre de la empresa por el que se va a realizar la búsqueda"
        required: true
        type: "string"
      responses:
        200:
          description: "Operación exitosa"
          schema:
            $ref: "#/definitions/Destinatario"
        401:
          $ref: '#/responses/UnauthorizedError'
        404:
          description: "No existe en la base de datos ninguna empresa que cumpla con los criterios de busqueda"
        409:
          description: "Se encontro en la base de datos mas de una empresa con el nombre consultado"
        500:
          $ref: '#/responses/InternalServerError'
  /test/nonblocking:
    get:
      tags:
      - "Destinatarios"
      summary: "Devuelve una lista de empresas"
      description: "Devuelve todos los datos de cada empresa listada. Se hace un select en la base de datos y se devuelve a partir de la empresa que coincida con {index} en la lista de empresas consultadas la cantidad de empresas indicadas en {count}. Es muy útil para mostrar empresas con paginado"
      operationId: "GET/destinatarios"
      produces:
      - "application/json"
      parameters:
      - name: "startindex"
        in: "query"
        description: "índice de la lista de empresas registradas a partir del cuál se van a devolver las empresas"
        required: true
        type: "integer"
        format: "int64"
      - name: "count"
        in: "query"
        description: "Cantidad de empresas que se van a devolver de la consulta"
        required: true
        type: "integer"
        format: "int32"
      responses:
        200:
          description: "Operación exitosa"
          schema:
            type: "array"
            items:
              $ref: "#/definitions/Destinatario"
        401:
          $ref: '#/responses/UnauthorizedError'
        404:
          description: "No existe en la base de datos ninguna empresa que cumpla con los criterios de busqueda"
        500:
          $ref: '#/responses/InternalServerError'
  /test/with-query-params:
    post:
      tags:
      - "Mails"
      summary: "Devuelve la cantidad de emails."
      description: "Devuelve la suma de la cantidad de emails registrados en la base de datos."
      operationId: "GET/emails/count"
      produces:
      - "application/json"
      responses:
        200:
          description: "Operación exitosa"
          schema:
            $ref: "#/definitions/EmailsCount"
        401:
          $ref: '#/responses/UnauthorizedError'
        500:
          $ref: '#/responses/InternalServerError'
  /test/with-json-body-params:
    put:
      tags:
      - "Mails"
      summary: "Inserta un email"
      description: "Inserta un email asociado a un destinatario."
      operationId: "PUT/emails"
      produces:
      - "application/json"
      parameters:
      - name: "destEmail"
        in: "query"
        description: "Dirección de correo a insertar."
        required: true
        type: "string"
        format: "email"
      - name: "emailDepartamento"
        in: "query"
        description: "Departamento de la empresa al que pertenece el mail. Debe ser uno de estos: DPD, COMERCIAL o GENERAL."
        required: true
        type: "string"
      - name: "destId"
        in: "query"
        description: "Id del destinatario en la base de datos."
        required: true
        type: "integer"
        format: "int32"
      responses:
        200:
          description: "Operación exitosa"
        400:
          description: "Bad Request"
        401:
          $ref: '#/responses/UnauthorizedError'
        500:
          $ref: '#/responses/InternalServerError'
definitions:
  Version:
    type: "object"
    properties:
      Api Version:
        type: "string"
        description: "Versión de API Destinatarios"
    xml:
      name: "Version"
responses:
  UnauthorizedError:
    description: Authentication information is missing or invalid
    headers:
      WWW_Authenticate:
        type: string
  InternalServerError:
    description: "Internal Server Error: Error desconocido en el procesamiento de la peticion HTTP. La causa de este error puede originarse en el servidor. En el mensaje de respuesta se dan detalles."
#externalDocs:
#  description: "Find out more about Swagger"
#  url: "http://swagger.io"